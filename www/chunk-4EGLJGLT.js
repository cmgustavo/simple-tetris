import{A as M,B as T,C as L,a as y,b as x,c as g,d as b,e as S,f as O,g as v,h as f,i as d,j as C,k as _,l as P,m as A,n as I,o as E,p as m,y as R,z as k}from"./chunk-AIK4DZQN.js";import"./chunk-NYXSTOWG.js";import"./chunk-O7BKAQHS.js";import"./chunk-K572LGMY.js";import"./chunk-M7FLRKQF.js";import"./chunk-JGEA7HOG.js";import"./chunk-R5HL6L5F.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-3QXY74KK.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";var a=10,u=20,n=20,w=["#f00","#0f0","#00f","#ff0","#0ff","#f0f","#aaa"],G=[[[1,1,1,1]],[[1,1],[1,1]],[[0,1,0],[1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]]],V=(()=>{let s=class s{constructor(){this.board=[],this.currentPiece=null,this.score=0,this.gameOver=!1,this.paused=!1}init(t){this.ctx=t,this.newGame()}newGame(){this.score=0,this.gameOver=!1,this.board=Array.from({length:u},()=>Array(a).fill(0)),this.spawnPiece(),clearInterval(this.interval),this.interval=setInterval(()=>this.update(),500),this.draw()}spawnPiece(){let t=Math.floor(Math.random()*G.length),e=G[t],i=w[t];this.currentPiece={shape:e,color:i,x:Math.floor(a/2)-Math.floor(e[0].length/2),y:0}}update(){this.gameOver||!this.currentPiece||(this.currentPiece.y++,this.collides()&&(this.currentPiece.y--,this.merge(),this.clearLines(),this.spawnPiece(),this.collides()&&(this.gameOver=!0,clearInterval(this.interval),this.draw())),this.draw())}collides(){if(!this.currentPiece)return!1;let{shape:t,x:e,y:i}=this.currentPiece;return t.some((r,c)=>r.some((o,h)=>o&&(i+c>=u||e+h<0||e+h>=a||this.board[i+c]?.[e+h])))}merge(){let{shape:t,x:e,y:i,color:r}=this.currentPiece;t.forEach((c,o)=>c.forEach((h,p)=>{h&&this.board[i+o]&&(this.board[i+o][e+p]=w.indexOf(r)+1)}))}draw(){if(this.ctx.clearRect(0,0,a*n,u*n),this.board.forEach((t,e)=>t.forEach((i,r)=>{i&&(this.ctx.fillStyle=w[i-1],this.ctx.fillRect(r*n,e*n,n,n))})),this.currentPiece){let{shape:t,color:e,x:i,y:r}=this.currentPiece;this.ctx.fillStyle=e,t.forEach((c,o)=>c.forEach((h,p)=>{h&&this.ctx.fillRect((i+p)*n,(r+o)*n,n,n)}))}if(this.ctx.fillStyle="#000",this.ctx.font="16px Arial",this.ctx.fillText("Score: "+this.score,5,20),this.paused&&!this.gameOver){let t=a*n/2,e=u*n/2;this.ctx.fillStyle="rgba(0, 0, 0, 0.8)",this.ctx.fillRect(0,e-30,a*n,60),this.ctx.fillStyle="#fff",this.ctx.font="20px Arial",this.ctx.textAlign="center",this.ctx.fillText("Paused",t,e),this.ctx.textAlign="start"}if(this.gameOver){let t=a*n/2,e=u*n/2;this.ctx.fillStyle="rgba(0, 0, 0, 0.8)",this.ctx.fillRect(0,e-40,a*n,80),this.ctx.fillStyle="#fff",this.ctx.font="20px Arial",this.ctx.textAlign="center",this.ctx.fillText("Game Over",t,e-5),this.ctx.font="16px Arial",this.ctx.fillText(`Final Score: ${this.score}`,t,e+20),this.ctx.textAlign="start"}}handleKey(t){if(!(!this.currentPiece||this.gameOver)){switch(t){case"ArrowLeft":this.currentPiece.x--,this.collides()&&this.currentPiece.x++;break;case"ArrowRight":this.currentPiece.x++,this.collides()&&this.currentPiece.x--;break;case"ArrowDown":if(this.currentPiece.y++,this.collides()&&(this.currentPiece.y--,this.merge(),this.clearLines(),this.spawnPiece(),this.collides()))return;break;case"ArrowUp":this.rotate();break}this.draw()}}rotate(){if(!this.currentPiece)return;let t=this.currentPiece.shape,e=t[0].map((r,c)=>t.map(o=>o[c]).reverse()),i=this.currentPiece.shape;this.currentPiece.shape=e,this.collides()&&(this.currentPiece.shape=i)}clearLines(){let t=0;for(this.board=this.board.filter(e=>{let i=e.every(r=>r);return i&&t++,!i});this.board.length<u;)this.board.unshift(Array(a).fill(0));this.score+=t*100}togglePause(){this.gameOver||(this.paused=!this.paused,this.paused?clearInterval(this.interval):this.interval=setInterval(()=>this.update(),500),this.draw())}};s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=y({token:s,factory:s.\u0275fac,providedIn:"root"});let l=s;return l})();var j=["gameCanvas"],D=(()=>{let s=class s{constructor(t){this.gameService=t}ngAfterViewInit(){let t=this.canvasRef.nativeElement.getContext("2d");t&&this.gameService.init(t),window.addEventListener("keydown",e=>this.gameService.handleKey(e.key))}newGame(){this.gameService.newGame()}pauseOrResume(){this.gameService.togglePause()}};s.\u0275fac=function(e){return new(e||s)(S(V))},s.\u0275cmp=O({type:s,selectors:[["app-home"]],viewQuery:function(e,i){if(e&1&&A(j,5),e&2){let r;I(r=E())&&(i.canvasRef=r.first)}},decls:16,vars:2,consts:[["gameCanvas",""],[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],["id","container"],["width","200","height","400"],["expand","block",3,"click"]],template:function(e,i){if(e&1){let r=_();f(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),m(3," Tetris "),d()()(),f(4,"ion-content",2)(5,"ion-header",3)(6,"ion-toolbar")(7,"ion-title",4),m(8,"Tetris"),d()()(),f(9,"div",5),C(10,"canvas",6,0),f(12,"ion-button",7),P("click",function(){return x(r),g(i.newGame())}),m(13,"New Game"),d(),f(14,"ion-button",7),P("click",function(){return x(r),g(i.pauseOrResume())}),m(15,"Pause / Resume"),d()()()}e&2&&(v("translucent",!0),b(4),v("fullscreen",!0))},dependencies:[M,L,T,k,R],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]});let l=s;return l})();export{D as HomePage};
